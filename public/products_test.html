<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>äº§å“ç§ç±»æµ‹è¯•</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        .debug { 
            background: #f0f0f0; 
            padding: 10px; 
            margin: 10px 0; 
            border-radius: 5px; 
            font-family: monospace;
        }
        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 24px;
            margin-top: 30px;
        }
        .product-card {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            transition: all 0.3s;
            cursor: pointer;
        }
        .product-image {
            width: 100%;
            height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 80px;
        }
        .product-info {
            padding: 20px;
        }
        .product-name {
            font-size: 20px;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 8px;
        }
        .product-category {
            display: inline-block;
            padding: 4px 12px;
            background: #e8f5e9;
            color: #4caf50;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            margin-bottom: 12px;
        }
        .product-desc {
            color: #5a6c7d;
            font-size: 14px;
            line-height: 1.6;
            margin-bottom: 16px;
        }
        .product-stats {
            display: flex;
            justify-content: space-between;
            padding-top: 16px;
            border-top: 1px solid #e8ecf1;
        }
        .product-stat {
            text-align: center;
        }
        .product-stat-value {
            font-size: 18px;
            font-weight: 700;
            color: #7c8ff5;
        }
        .product-stat-label {
            font-size: 12px;
            color: #8492a6;
            margin-top: 4px;
        }
    </style>
</head>
<body>
    <div class="main-container">
        <h1>äº§å“ç§ç±»æµ‹è¯•é¡µé¢</h1>
        
        <div class="debug" id="debug">
            è°ƒè¯•ä¿¡æ¯å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ...
        </div>
        
        <button onclick="testRender()">æµ‹è¯•æ¸²æŸ“</button>
        <button onclick="testAPI()">æµ‹è¯• API</button>
        
        <div class="products-grid" id="productsGrid">
            <!-- äº§å“å¡ç‰‡å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ -->
        </div>
    </div>

    <script>
        const debugDiv = document.getElementById('debug');
        
        function log(message) {
            console.log(message);
            debugDiv.innerHTML += message + '<br>';
        }
        
        const products = [
            {
                id: 1,
                name: 'æœ‰æœºå¤§ç±³',
                category: 'grain',
                categoryName: 'ç²®é£Ÿä½œç‰©',
                icon: 'ğŸŒ¾',
                desc: 'æ¥è‡ªé»‘é¾™æ±Ÿäº”å¸¸çš„ä¼˜è´¨æœ‰æœºå¤§ç±³ï¼Œæ— å†œè¯æ— åŒ–è‚¥ï¼Œå£æ„Ÿé¦™ç”œè½¯ç³¯',
                batches: 1250,
                enterprises: 45,
                color: '#FFD700'
            },
            {
                id: 2,
                name: 'æ™®æ´±èŒ¶',
                category: 'tea',
                categoryName: 'èŒ¶å¶',
                icon: 'ğŸµ',
                desc: 'äº‘å—æ™®æ´±å¤æ ‘èŒ¶ï¼Œç»è¿‡ä¼ ç»Ÿå·¥è‰ºå‘é…µï¼ŒèŒ¶é¦™æµ“éƒï¼Œå›ç”˜æŒä¹…',
                batches: 856,
                enterprises: 32,
                color: '#8B4513'
            },
            {
                id: 3,
                name: 'æ–°é²œè”¬èœ',
                category: 'vegetable',
                categoryName: 'è”¬èœ',
                icon: 'ğŸ¥¬',
                desc: 'å±±ä¸œå¯¿å…‰å¤§æ£šè”¬èœï¼Œæ–°é²œé‡‡æ‘˜ï¼Œç»¿è‰²å¥åº·ï¼Œå½“æ—¥é…é€',
                batches: 2340,
                enterprises: 78,
                color: '#32CD32'
            }
        ];
        
        function renderProducts() {
            log(`å¼€å§‹æ¸²æŸ“äº§å“ï¼Œäº§å“æ•°é‡: ${products.length}`);
            
            const grid = document.getElementById('productsGrid');
            if (!grid) {
                log('é”™è¯¯ï¼šæ‰¾ä¸åˆ° productsGrid å…ƒç´ ');
                return;
            }
            
            log('æ‰¾åˆ° grid å…ƒç´ ï¼Œå¼€å§‹ç”Ÿæˆ HTML');
            
            const html = products.map(product => `
                <div class="product-card" onclick="viewProduct(${product.id})">
                    <div class="product-image" style="background: linear-gradient(135deg, ${product.color}dd 0%, ${product.color}88 100%);">
                        ${product.icon}
                    </div>
                    <div class="product-info">
                        <div class="product-name">${product.name}</div>
                        <span class="product-category">${product.categoryName}</span>
                        <div class="product-desc">${product.desc}</div>
                        <div class="product-stats">
                            <div class="product-stat">
                                <div class="product-stat-value">${product.batches}</div>
                                <div class="product-stat-label">æº¯æºæ‰¹æ¬¡</div>
                            </div>
                            <div class="product-stat">
                                <div class="product-stat-value">${product.enterprises}</div>
                                <div class="product-stat-label">ç”Ÿäº§ä¼ä¸š</div>
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
            
            log(`ç”Ÿæˆçš„ HTML é•¿åº¦: ${html.length}`);
            grid.innerHTML = html;
            log('HTML å·²æ’å…¥åˆ° grid ä¸­');
        }
        
        function testRender() {
            log('=== å¼€å§‹æµ‹è¯•æ¸²æŸ“ ===');
            renderProducts();
        }
        
        async function testAPI() {
            log('=== å¼€å§‹æµ‹è¯• API ===');
            try {
                const response = await fetch('/api/products');
                log(`API å“åº”çŠ¶æ€: ${response.status}`);
                
                const data = await response.json();
                log(`API å“åº”æ•°æ®: ${JSON.stringify(data, null, 2)}`);
                
                if (data.ok && data.products) {
                    log(`ä» API è·å–åˆ° ${data.products.length} ä¸ªäº§å“`);
                    // ä½¿ç”¨ API æ•°æ®æ›´æ–°äº§å“åˆ—è¡¨
                    products.length = 0; // æ¸…ç©ºç°æœ‰æ•°æ®
                    products.push(...data.products);
                    renderProducts();
                } else {
                    log('API è¿”å›æ•°æ®æ ¼å¼ä¸æ­£ç¡®');
                }
            } catch (error) {
                log(`API è°ƒç”¨å¤±è´¥: ${error.message}`);
            }
        }
        
        function viewProduct(id) {
            const product = products.find(p => p.id === id);
            alert(`æŸ¥çœ‹äº§å“è¯¦æƒ…ï¼š${product.name}`);
        }
        
        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æ¸²æŸ“
        window.addEventListener('load', function() {
            log('é¡µé¢åŠ è½½å®Œæˆ');
            testRender();
        });
    </script>
</body>
</html>